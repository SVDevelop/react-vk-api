{"ast":null,"code":"import _objectSpread from \"/home/serg/Documents/react/react-vk-api/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _regeneratorRuntime from \"/home/serg/Documents/react/react-vk-api/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/serg/Documents/react/react-vk-api/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/serg/Documents/react/react-vk-api/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/home/serg/Documents/react/react-vk-api/src/VK/index.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\n/* global VK */\nimport { createContext, useCallback, useContext, useEffect, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar VKContext = /*#__PURE__*/createContext();\nexport function useVK() {\n  _s();\n\n  return useContext(VKContext);\n}\n\n_s(useVK, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport function VKProvider(props) {\n  _s2();\n\n  var children = props.children;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      authenticated = _useState2[0],\n      setAuthenticated = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      user = _useState4[0],\n      setUser = _useState4[1];\n\n  var login = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!authenticated) {\n              VK.Auth.login(function (response) {\n                if (response.status === \"connected\") {\n                  setUser(response.session.user);\n                  setAuthenticated(true);\n                }\n              });\n            }\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), [authenticated]);\n  useEffect(function () {\n    VK.Auth.getLoginStatus(function (response) {\n      if (response.status === \"connected\") {\n        setUser(response.session.user);\n        setAuthenticated(true);\n      }\n    }, true);\n  }, []);\n  var call = useCallback(function (method) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return new Promise(function (resolve) {\n      VK.Api.call(method, _objectSpread({\n        v: \"5.54\"\n      }, params), resolve);\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(VKContext.Provider, {\n    value: {\n      authenticated: authenticated,\n      login: login,\n      user: user,\n      call: call\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 5\n  }, this);\n}\n\n_s2(VKProvider, \"WgB+XNXhfPKHW+Md0UphRZXyv84=\");\n\n_c = VKProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"VKProvider\");","map":{"version":3,"sources":["/home/serg/Documents/react/react-vk-api/src/VK/index.js"],"names":["createContext","useCallback","useContext","useEffect","useState","VKContext","useVK","VKProvider","props","children","authenticated","setAuthenticated","user","setUser","login","VK","Auth","response","status","session","getLoginStatus","call","method","params","Promise","resolve","Api","v"],"mappings":";;;;;;;;;AAAA;AAEA,SACEA,aADF,EAEEC,WAFF,EAGEC,UAHF,EAIEC,SAJF,EAKEC,QALF,QAMO,OANP;;AAQA,IAAMC,SAAS,gBAAGL,aAAa,EAA/B;AAEA,OAAO,SAASM,KAAT,GAAiB;AAAA;;AACtB,SAAOJ,UAAU,CAACG,SAAD,CAAjB;AACD;;GAFeC,K;;AAIhB,OAAO,SAASC,UAAT,CAAoBC,KAApB,EAA2B;AAAA;;AAChC,MAAQC,QAAR,GAAqBD,KAArB,CAAQC,QAAR;;AAEA,kBAA0CL,QAAQ,CAAC,KAAD,CAAlD;AAAA;AAAA,MAAOM,aAAP;AAAA,MAAsBC,gBAAtB;;AACA,mBAAwBP,QAAQ,CAAC,IAAD,CAAhC;AAAA;AAAA,MAAOQ,IAAP;AAAA,MAAaC,OAAb;;AAEA,MAAMC,KAAK,GAAGb,WAAW,wEAAC;AAAA;AAAA;AAAA;AAAA;AACxB,gBAAI,CAACS,aAAL,EAAoB;AAClBK,cAAAA,EAAE,CAACC,IAAH,CAAQF,KAAR,CAAc,UAACG,QAAD,EAAc;AAC1B,oBAAIA,QAAQ,CAACC,MAAT,KAAoB,WAAxB,EAAqC;AACnCL,kBAAAA,OAAO,CAACI,QAAQ,CAACE,OAAT,CAAiBP,IAAlB,CAAP;AACAD,kBAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACD;AACF,eALD;AAMD;;AARuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD,IAStB,CAACD,aAAD,CATsB,CAAzB;AAWAP,EAAAA,SAAS,CAAC,YAAM;AACdY,IAAAA,EAAE,CAACC,IAAH,CAAQI,cAAR,CAAuB,UAACH,QAAD,EAAc;AACnC,UAAIA,QAAQ,CAACC,MAAT,KAAoB,WAAxB,EAAqC;AACnCL,QAAAA,OAAO,CAACI,QAAQ,CAACE,OAAT,CAAiBP,IAAlB,CAAP;AACAD,QAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACD;AACF,KALD,EAKG,IALH;AAMD,GAPQ,EAON,EAPM,CAAT;AASA,MAAMU,IAAI,GAAGpB,WAAW,CAAC,UAACqB,MAAD,EAAyB;AAAA,QAAhBC,MAAgB,uEAAP,EAAO;AAChD,WAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;AAC9BV,MAAAA,EAAE,CAACW,GAAH,CAAOL,IAAP,CAAYC,MAAZ;AAAsBK,QAAAA,CAAC,EAAE;AAAzB,SAAoCJ,MAApC,GAA8CE,OAA9C;AACD,KAFM,CAAP;AAGD,GAJuB,EAIrB,EAJqB,CAAxB;AAMA,sBACE,QAAC,SAAD,CAAW,QAAX;AAAoB,IAAA,KAAK,EAAE;AAAEf,MAAAA,aAAa,EAAbA,aAAF;AAAiBI,MAAAA,KAAK,EAALA,KAAjB;AAAwBF,MAAAA,IAAI,EAAJA,IAAxB;AAA8BS,MAAAA,IAAI,EAAJA;AAA9B,KAA3B;AAAA,cACGZ;AADH;AAAA;AAAA;AAAA;AAAA,UADF;AAKD;;IArCeF,U;;KAAAA,U","sourcesContent":["/* global VK */\n\nimport {\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useState\n} from \"react\";\n\nconst VKContext = createContext();\n\nexport function useVK() {\n  return useContext(VKContext);\n}\n\nexport function VKProvider(props) {\n  const { children } = props;\n\n  const [authenticated, setAuthenticated] = useState(false);\n  const [user, setUser] = useState(null);\n\n  const login = useCallback(async () => {\n    if (!authenticated) {\n      VK.Auth.login((response) => {\n        if (response.status === \"connected\") {\n          setUser(response.session.user);\n          setAuthenticated(true);\n        }\n      });\n    }\n  }, [authenticated]);\n\n  useEffect(() => {\n    VK.Auth.getLoginStatus((response) => {\n      if (response.status === \"connected\") {\n        setUser(response.session.user);\n        setAuthenticated(true);\n      }\n    }, true);\n  }, []);\n\n  const call = useCallback((method, params = {}) => {\n    return new Promise((resolve) => {\n      VK.Api.call(method, { v: \"5.54\", ...params }, resolve);\n    });\n  }, []);\n\n  return (\n    <VKContext.Provider value={{ authenticated, login, user, call }}>\n      {children}\n    </VKContext.Provider>\n  );\n}\n\n"]},"metadata":{},"sourceType":"module"}